"use strict";(self.webpackChunktrades_manager=self.webpackChunktrades_manager||[]).push([[60],{6060:(se,O,p)=>{p.r(O),p.d(O,{BalanceChartModule:()=>ie});var T=p(8583),b=p(9765),z=p(5917),P=p(7574),C=p(2836),L=p(739),B=p(2759),o=p(7716),_=p(9773),j=p(8002),I=p(3190),$=p(4395);const R=["*"];var l=(()=>{return(t=l||(l={})).AnnotationChart="AnnotationChart",t.AreaChart="AreaChart",t.Bar="Bar",t.BarChart="BarChart",t.BubbleChart="BubbleChart",t.Calendar="Calendar",t.CandlestickChart="CandlestickChart",t.ColumnChart="ColumnChart",t.ComboChart="ComboChart",t.PieChart="PieChart",t.Gantt="Gantt",t.Gauge="Gauge",t.GeoChart="GeoChart",t.Histogram="Histogram",t.Line="Line",t.LineChart="LineChart",t.Map="Map",t.OrgChart="OrgChart",t.Sankey="Sankey",t.Scatter="Scatter",t.ScatterChart="ScatterChart",t.SteppedAreaChart="SteppedAreaChart",t.Table="Table",t.Timeline="Timeline",t.TreeMap="TreeMap",t.WordTree="wordtree",l;var t})();const Q={[l.AnnotationChart]:"annotationchart",[l.AreaChart]:"corechart",[l.Bar]:"bar",[l.BarChart]:"corechart",[l.BubbleChart]:"corechart",[l.Calendar]:"calendar",[l.CandlestickChart]:"corechart",[l.ColumnChart]:"corechart",[l.ComboChart]:"corechart",[l.PieChart]:"corechart",[l.Gantt]:"gantt",[l.Gauge]:"gauge",[l.GeoChart]:"geochart",[l.Histogram]:"corechart",[l.Line]:"line",[l.LineChart]:"corechart",[l.Map]:"map",[l.OrgChart]:"orgchart",[l.Sankey]:"sankey",[l.Scatter]:"scatter",[l.ScatterChart]:"corechart",[l.SteppedAreaChart]:"corechart",[l.Table]:"table",[l.Timeline]:"timeline",[l.TreeMap]:"treemap",[l.WordTree]:"wordtree"},M=new o.OlP("GOOGLE_CHARTS_CONFIG"),J=new o.OlP("GOOGLE_CHARTS_LAZY_CONFIG",{providedIn:"root",factory:()=>{const t=(0,o.f3M)(M,o.XFs.Optional);return(0,z.of)(Object.assign(Object.assign({},{version:"current",safeMode:!1}),t||{}))}});let g=(()=>{class t{constructor(e,r,n){this.zone=e,this.localeId=r,this.config$=n,this.scriptSource="https://www.gstatic.com/charts/loader.js",this.scriptLoadSubject=new b.xQ}isGoogleChartsAvailable(){return!("undefined"==typeof google||void 0===google.charts)}loadChartPackages(...e){return this.loadGoogleCharts().pipe((0,_.zg)(()=>this.config$),(0,j.U)(r=>Object.assign(Object.assign({},{version:"current",safeMode:!1}),r||{})),(0,I.w)(r=>new P.y(n=>{google.charts.load(r.version,{packages:e,language:this.localeId,mapsApiKey:r.mapsApiKey,safeMode:r.safeMode}),google.charts.setOnLoadCallback(()=>{this.zone.run(()=>{n.next(),n.complete()})})})))}loadGoogleCharts(){if(this.isGoogleChartsAvailable())return(0,z.of)(null);if(!this.isLoadingGoogleCharts()){const e=this.createGoogleChartsScript();e.onload=()=>{this.zone.run(()=>{this.scriptLoadSubject.next(),this.scriptLoadSubject.complete()})},e.onerror=()=>{this.zone.run(()=>{console.error("Failed to load the google charts script!"),this.scriptLoadSubject.error(new Error("Failed to load the google charts script!"))})}}return this.scriptLoadSubject.asObservable()}isLoadingGoogleCharts(){return null!=this.getGoogleChartsScript()}getGoogleChartsScript(){return Array.from(document.getElementsByTagName("script")).find(r=>r.src===this.scriptSource)}createGoogleChartsScript(){const e=document.createElement("script");return e.type="text/javascript",e.src=this.scriptSource,e.async=!0,document.getElementsByTagName("head")[0].appendChild(e),e}}return t.\u0275fac=function(e){return new(e||t)(o.LFG(o.R0b),o.LFG(o.soG),o.LFG(J))},t.\u0275prov=o.Yz7({token:t,factory:t.\u0275fac}),t})(),F=(()=>{class t{create(e,r,n){if(null==e)return;let i=!0;null!=r&&(i=!1);const s=google.visualization.arrayToDataTable(this.getDataAsTable(e,r),i);return n&&this.applyFormatters(s,n),s}getDataAsTable(e,r){return r?[r,...e]:e}applyFormatters(e,r){for(const n of r)n.formatter.format(e,n.colIndex)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=o.Yz7({factory:function(){return new t},token:t,providedIn:"root"}),t})(),Z=(()=>{class t{constructor(e){this.loaderService=e,this.error=new o.vpe,this.ready=new o.vpe,this.stateChange=new o.vpe,this.id="_"+Math.random().toString(36).substr(2,9),this.wrapperReadySubject=new C.t(1)}get wrapperReady$(){return this.wrapperReadySubject.asObservable()}get controlWrapper(){if(!this._controlWrapper)throw new Error("Cannot access the control wrapper before it being initialized.");return this._controlWrapper}ngOnInit(){this.loaderService.loadChartPackages("controls").subscribe(()=>{this.createControlWrapper()})}ngOnChanges(e){!this._controlWrapper||(e.type&&this._controlWrapper.setControlType(this.type),e.options&&this._controlWrapper.setOptions(this.options||{}),e.state&&this._controlWrapper.setState(this.state||{}))}createControlWrapper(){this._controlWrapper=new google.visualization.ControlWrapper({containerId:this.id,controlType:this.type,state:this.state,options:this.options}),this.addEventListeners(),this.wrapperReadySubject.next(this._controlWrapper)}addEventListeners(){google.visualization.events.removeAllListeners(this._controlWrapper),google.visualization.events.addListener(this._controlWrapper,"ready",e=>this.ready.emit(e)),google.visualization.events.addListener(this._controlWrapper,"error",e=>this.error.emit(e)),google.visualization.events.addListener(this._controlWrapper,"statechange",e=>this.stateChange.emit(e))}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(g))},t.\u0275cmp=o.Xpm({type:t,selectors:[["control-wrapper"]],hostAttrs:[1,"control-wrapper"],hostVars:1,hostBindings:function(e,r){2&e&&o.Ikx("id",r.id)},inputs:{for:"for",type:"type",options:"options",state:"state"},outputs:{error:"error",ready:"ready",stateChange:"stateChange"},exportAs:["controlWrapper"],features:[o.TTD],decls:0,vars:0,template:function(e,r){},encapsulation:2,changeDetection:0}),t})(),K=(()=>{class t{constructor(e,r,n){this.element=e,this.loaderService=r,this.dataTableService=n,this.ready=new o.vpe,this.error=new o.vpe,this.initialized=!1}ngOnInit(){this.loaderService.loadChartPackages("controls").subscribe(()=>{this.dataTable=this.dataTableService.create(this.data,this.columns,this.formatters),this.createDashboard(),this.initialized=!0})}ngOnChanges(e){!this.initialized||(e.data||e.columns||e.formatters)&&(this.dataTable=this.dataTableService.create(this.data,this.columns,this.formatters),this.dashboard.draw(this.dataTable))}createDashboard(){const e=this.controlWrappers.map(n=>n.wrapperReady$),r=this.controlWrappers.map(n=>n.for).map(n=>Array.isArray(n)?(0,L.aj)(n.map(i=>i.wrapperReady$)):n.wrapperReady$);(0,L.aj)([...e,...r]).subscribe(()=>{this.dashboard=new google.visualization.Dashboard(this.element.nativeElement),this.initializeBindings(),this.registerEvents(),this.dashboard.draw(this.dataTable)})}registerEvents(){google.visualization.events.removeAllListeners(this.dashboard);const e=(r,n,i)=>{google.visualization.events.addListener(r,n,i)};e(this.dashboard,"ready",()=>this.ready.emit()),e(this.dashboard,"error",r=>this.error.emit(r))}initializeBindings(){this.controlWrappers.forEach(e=>{if(Array.isArray(e.for)){const r=e.for.map(n=>n.chartWrapper);this.dashboard.bind(e.controlWrapper,r)}else this.dashboard.bind(e.controlWrapper,e.for.chartWrapper)})}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(o.SBq),o.Y36(g),o.Y36(F))},t.\u0275cmp=o.Xpm({type:t,selectors:[["dashboard"]],contentQueries:function(e,r,n){if(1&e&&o.Suo(n,Z,4),2&e){let i;o.iGM(i=o.CRH())&&(r.controlWrappers=i)}},hostAttrs:[1,"dashboard"],inputs:{data:"data",columns:"columns",formatters:"formatters"},outputs:{ready:"ready",error:"error"},exportAs:["dashboard"],features:[o.TTD],ngContentSelectors:R,decls:1,vars:0,template:function(e,r){1&e&&(o.F$t(),o.Hsn(0))},encapsulation:2,changeDetection:0}),t})(),k=(()=>{class t{constructor(e,r,n,i){this.element=e,this.scriptLoaderService=r,this.dataTableService=n,this.dashboard=i,this.options={},this.dynamicResize=!1,this.ready=new o.vpe,this.error=new o.vpe,this.select=new o.vpe,this.mouseover=new o.vpe,this.mouseleave=new o.vpe,this.wrapperReadySubject=new C.t(1),this.initialized=!1,this.eventListeners=new Map}get chart(){return this.chartWrapper.getChart()}get wrapperReady$(){return this.wrapperReadySubject.asObservable()}get chartWrapper(){if(!this.wrapper)throw new Error("Trying to access the chart wrapper before it was fully initialized");return this.wrapper}set chartWrapper(e){this.wrapper=e,this.drawChart()}ngOnInit(){this.scriptLoaderService.loadChartPackages(function(t){return Q[t]}(this.type)).subscribe(()=>{this.dataTable=this.dataTableService.create(this.data,this.columns,this.formatters),this.wrapper=new google.visualization.ChartWrapper({container:this.element.nativeElement,chartType:this.type,dataTable:this.dataTable,options:this.mergeOptions()}),this.registerChartEvents(),this.wrapperReadySubject.next(this.wrapper),this.initialized=!0,this.drawChart()})}ngOnChanges(e){if(e.dynamicResize&&this.updateResizeListener(),this.initialized){let r=!1;(e.data||e.columns||e.formatters)&&(this.dataTable=this.dataTableService.create(this.data,this.columns,this.formatters),this.wrapper.setDataTable(this.dataTable),r=!0),e.type&&(this.wrapper.setChartType(this.type),r=!0),(e.options||e.width||e.height||e.title)&&(this.wrapper.setOptions(this.mergeOptions()),r=!0),r&&this.drawChart()}}ngOnDestroy(){this.unsubscribeToResizeIfSubscribed()}addEventListener(e,r){const n=this.registerChartEvent(this.chart,e,r);return this.eventListeners.set(n,{eventName:e,callback:r,handle:n}),n}removeEventListener(e){const r=this.eventListeners.get(e);r&&(google.visualization.events.removeListener(r.handle),this.eventListeners.delete(e))}updateResizeListener(){this.unsubscribeToResizeIfSubscribed(),this.dynamicResize&&(this.resizeSubscription=(0,B.R)(window,"resize",{passive:!0}).pipe((0,$.b)(100)).subscribe(()=>{this.initialized&&this.drawChart()}))}unsubscribeToResizeIfSubscribed(){null!=this.resizeSubscription&&(this.resizeSubscription.unsubscribe(),this.resizeSubscription=void 0)}mergeOptions(){return Object.assign({title:this.title,width:this.width,height:this.height},this.options)}registerChartEvents(){google.visualization.events.removeAllListeners(this.wrapper),this.registerChartEvent(this.wrapper,"ready",()=>{google.visualization.events.removeAllListeners(this.chart),this.registerChartEvent(this.chart,"onmouseover",e=>this.mouseover.emit(e)),this.registerChartEvent(this.chart,"onmouseout",e=>this.mouseleave.emit(e)),this.registerChartEvent(this.chart,"select",()=>{const e=this.chart.getSelection();this.select.emit({selection:e})}),this.eventListeners.forEach(e=>e.handle=this.registerChartEvent(this.chart,e.eventName,e.callback)),this.ready.emit({chart:this.chart})}),this.registerChartEvent(this.wrapper,"error",e=>this.error.emit(e))}registerChartEvent(e,r,n){return google.visualization.events.addListener(e,r,n)}drawChart(){null==this.dashboard&&this.wrapper.draw()}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(o.SBq),o.Y36(g),o.Y36(F),o.Y36(K,8))},t.\u0275cmp=o.Xpm({type:t,selectors:[["google-chart"]],hostAttrs:[1,"google-chart"],inputs:{options:"options",dynamicResize:"dynamicResize",type:"type",data:"data",columns:"columns",title:"title",width:"width",height:"height",formatters:"formatters"},outputs:{ready:"ready",error:"error",select:"select",mouseover:"mouseover",mouseleave:"mouseleave"},exportAs:["googleChart"],features:[o.TTD],decls:0,vars:0,template:function(e,r){},styles:["[_nghost-%COMP%] { width: fit-content; display: block; }"],changeDetection:0}),t})(),q=(()=>{class t{static forRoot(e={}){return{ngModule:t,providers:[{provide:M,useValue:e}]}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({providers:[g]}),t})();var x=p(9763),ee=p(5458);p(3684);var re=p(5572);const ae=[{path:"",component:(()=>{class t{constructor(e){this._tradesService=e,this.chartType=l.LineChart,this.chartOptions={title:"Balance Changes",legend:{position:"bottom"},interpolateNulls:!0,series:[{color:"orange",visibleInLegend:!0,labelInLegend:"User Balance",lineWidth:3,pointsVisible:!0}],vAxis:{format:"currency"}},this.chartData$=this._tradesService.trades$.pipe((0,j.U)(r=>function(t){const a={};return t.forEach(e=>{const r=e.exitDate.toLocaleDateString();a[r]||(a[r]=0),a[r]+=(0,ee.$)(e.entryPrice,e.exitPrice)}),Object.keys(a).reduce((e,r)=>(e.push([r,a[r]]),e),[]).sort((e,r)=>e[0]<r[0]?-1:e[0]>r[0]?1:0)}(r)))}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(re.G))},t.\u0275cmp=o.Xpm({type:t,selectors:[["app-main-balance-chart"]],decls:2,vars:5,consts:[[2,"width","100%",3,"type","options","data"]],template:function(e,r){1&e&&(o._UZ(0,"google-chart",0),o.ALo(1,"async")),2&e&&o.Q6J("type",r.chartType)("options",r.chartOptions)("data",o.lcZ(1,3,r.chartData$))},directives:[k],pipes:[T.Ov],encapsulation:2,changeDetection:0}),t})()}];let ne=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[[x.Bz.forChild(ae)],x.Bz]}),t})(),ie=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[[ne,T.ez,q]]}),t})()}}]);